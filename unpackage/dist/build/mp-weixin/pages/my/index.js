(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/index"],{"0f17":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"4806"))}},s=function(){var e=this.$createElement;this._self._c},i=[]},"1b47":function(e,t,n){},"22dd":function(e,t,n){"use strict";(function(e){var t=n("4ea4");n("8cfb");t(n("66fd"));var o=t(n("5ee1"));wx.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("543d")["createPage"])},"5ee1":function(e,t,n){"use strict";n.r(t);var o=n("0f17"),s=n("dbca");for(var i in s)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(i);n("f864");var a=n("f0c5"),r=Object(a["a"])(s["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=r.exports},"8eb7":function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,i=o(n("9523")),a=o(n("253c")),r={created:function(){s=this},data:function(){var t;return t={isLogin:!1,phone:"",timestamp:""},(0,i.default)(t,"phone",""),(0,i.default)(t,"code",""),(0,i.default)(t,"password",""),(0,i.default)(t,"second",59),(0,i.default)(t,"isSend",!1),(0,i.default)(t,"isPassword",!1),(0,i.default)(t,"codeLoginCss","#50a0f0"),(0,i.default)(t,"pwdLoginCss",{color:"","font-weight":""}),(0,i.default)(t,"userInfo",{}),(0,i.default)(t,"carouselList",[]),(0,i.default)(t,"myAppList",[]),(0,i.default)(t,"appList",[{url:"../../static/imgs/my/integral.png",name:"积分中心",pageUrl:"/pages/integral/index"},{url:"../../static/imgs/my/issue.png",name:"问题反馈",pageUrl:"/pages/other/message"},{url:"../../static/imgs/my/contactAuthor.png",name:"联系作者",pageUrl:"/pages/other/author"},{url:"../../static/imgs/my/set.png",name:"设置",pageUrl:"/pages/my/set"}]),(0,i.default)(t,"otherAppList",[{url:"../../static/imgs/home/webside.png",name:"网站推荐",pageUrl:"/pages/article/detail?id=2"},{url:"../../static/imgs/my/box.png",name:"实用工具",pageUrl:"wx678dafe70a79518a"}]),(0,i.default)(t,"toAdvert",(function(t){e.showModal({title:"标题",content:t.title,showCancel:!1,success:function(){}})})),t},onShow:function(){this.getUserInfo()},onLoad:function(){this.queryCarouselData(1,1)},methods:{queryMyApp:function(){var e=this;a.default.queryMyApp({}).then((function(t){e.myAppList=t.data,t.data.length>1&&(e.myAppList[1].pageUrl="/pages/my/myTrends?userId=".concat(e.userInfo.id))}))},queryCarouselData:function(e,t){var n=this;a.default.queryCarousel({page:e,limit:t,type:"3"}).then((function(e){n.carouselList=e.data.list}))},getUserInfo:function(){var t=this;a.default.userInfo({}).then((function(n){if(10020!=n.code&&10021!=n.code){if(0!=n.code)return e.showToast({title:n.msg,icon:"error"}),void(t.isLogin=!1);t.userInfo=n.data,e.setStorageSync("userInfo",n.data),t.isLogin=!0,t.queryMyApp()}else t.isLogin=!1}))},loginByPwd:function(t,n){var o=this;a.default.loginByPwd({mobile:t,password:n}).then((function(t){0==t.code?(e.setStorageSync("token",t.data.token),e.setStorageSync("userInfo",t.data),e.showToast({title:"登录成功",icon:"none"}),o.userInfo=t.data,o.isLogin=!0,o.getUserInfo(),o.closePhone()):e.showToast({title:t.msg,icon:"none"})}))},loginByCode:function(t,n,o){var s=this;a.default.loginByCode({phone:t,timestamp:o,code:n}).then((function(t){0==t.code?(e.setStorageSync("token",t.data.token),e.setStorageSync("userInfo",t.data),e.showToast({title:"登录成功",icon:"none"}),s.userInfo=t.data,s.isLogin=!0,s.getUserInfo(),s.closePhone()):e.showToast({title:t.msg,icon:"error"})}))},toAppDetail:function(t){""!=t.pageUrl?0!=t.pageUrl.indexOf("wx")?e.navigateTo({url:"".concat(t.pageUrl)}):e.navigateToMiniProgram({appId:t.pageUrl,success:function(e){},fail:function(e){}}):e.showToast({title:"功能完善中",icon:"none"})},toEditInfo:function(){e.navigateTo({url:"/pages/my/editInfo?phone=".concat(this.userInfo.mobile)})},openPhone:function(){this.$refs.popup.open("center")},closePhone:function(){this.$refs.popup.close()},sendCodeBtn:function(){""!=this.phone?this.sendCode():e.showToast({title:"请填写手机号",icon:"none"})},sendCode:function(){var t=this,n=Date.now();this.timestamp=n,a.default.sendCode({phone:this.phone,timestamp:n}).then((function(n){if(0==n.code){t.isSend=!0;var o=setInterval((function(){var e=s.second--;e<=1&&(s.isSend=!1,s.second=59,clearInterval(o))}),1e3)}else e.showToast({title:n.msg,icon:"error"})}))},confirm:function(){""!=this.phone?this.isPassword||""!=this.code?this.isPassword&&""==this.password?e.showToast({title:"请输入密码",icon:"none"}):this.isPassword?this.loginByPwd(this.phone,this.password):this.loginByCode(this.phone,this.code,this.timestamp):e.showToast({title:"请输入验证码",icon:"none"}):e.showToast({title:"请填写手机号",icon:"none"})},changeCodeLogin:function(){this.codeLoginCss="#50a0f0",this.pwdLoginCss="",this.isPassword=!1,this.password=""},changePwdLogin:function(){this.codeLoginCss="",this.pwdLoginCss="#50a0f0",this.isPassword=!0,this.code=""},toUser:function(t){e.navigateTo({url:"/pages/my/user?userId=".concat(t)})},logout:function(){var t=this;a.default.logout({}).then((function(n){0==n.code?(t.userInfo={},t.isLogin=!1,e.removeStorageSync("token"),e.removeStorageSync("userInfo"),e.showToast({title:"登出成功",icon:"none"})):e.showToast({title:n.msg,icon:"error"})}))}}};t.default=r}).call(this,n("543d")["default"])},dbca:function(e,t,n){"use strict";n.r(t);var o=n("8eb7"),s=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=s.a},f864:function(e,t,n){"use strict";var o=n("1b47"),s=n.n(o);s.a}},[["22dd","common/runtime","common/vendor"]]]);